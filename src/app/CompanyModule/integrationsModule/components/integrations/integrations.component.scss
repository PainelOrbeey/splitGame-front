/* Derivados úteis (ajustam-se com o tema) */
:host{
  --border-weak: color-mix(in srgb, var(--text-main) 14%, transparent);
  --muted:       color-mix(in srgb, var(--text-main) 55%, transparent);
  --hover:       color-mix(in srgb, var(--text-main) 6%, transparent);
  --panel:       color-mix(in srgb, var(--card-bg) 92%, var(--bg-main) 8%);
  --panel-strong:color-mix(in srgb, var(--card-bg) 84%, var(--bg-main) 16%);
  --shadow-1:    0 1px 3px rgba(0,0,0,.1);
  --shadow-2:    0 8px 25px rgba(0,0,0,.1);
}

/* ================= FILTERS ================= */
.filters-section{
  display:flex; gap:16px; margin-bottom:32px; align-items:center;

  .search-bar{
    position:relative; flex:1; max-width:400px;

    .pi-search{
      position:absolute; left:16px; top:50%; transform:translateY(-50%);
      color:var(--muted); font-size:14px;
    }

    .search-input{
      width:100%;
      padding:12px 16px 12px 44px;
      border:1px solid var(--border-color);
      border-radius:8px;
      font-size:14px;
      background:var(--card-bg);
      color:var(--text-main);
      transition:all .2s;

      &:focus{
        outline:none;
        border-color:var(--blue-500);
        box-shadow:0 0 0 3px color-mix(in srgb, var(--blue-500) 18%, transparent);
      }
    }
  }

  .filter-selects{
    display:flex; gap:12px;

    .filter-select{
      padding:12px 16px;
      border:1px solid var(--border-color);
      border-radius:8px;
      background:var(--card-bg);
      color:var(--text-main);
      font-size:14px; min-width:140px; cursor:pointer; transition:all .2s;

      &:focus{
        outline:none;
        border-color:var(--blue-500);
        box-shadow:0 0 0 3px color-mix(in srgb, var(--blue-500) 18%, transparent);
      }
    }
  }
}

/* ================= GRID ================= */
.integrations-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill, minmax(380px, 1fr));
  gap:24px;
}

/* ================= CARD ================= */
.integration-card{
  background:var(--card-bg);
  border-radius:12px;
  border:1px solid var(--border-color);
  overflow:hidden;
  transition:all .3s ease;
  position:relative;

  &:hover{ transform:translateY(-2px); box-shadow:var(--shadow-2); }

  /* status laterais (mantidos em cores semânticas) */
  &.card-connected{    border-left:4px solid #10b981; }
  &.card-error{        border-left:4px solid #ef4444; }
  &.card-pending{      border-left:4px solid #f59e0b; }
  &.card-disconnected{ border-left:4px solid #6b7280; }

  .card-header{
    padding:20px; display:flex; align-items:center; gap:16px;
    border-bottom:1px solid color-mix(in srgb, var(--border-color) 80%, transparent);

    .integration-icon{
      width:48px; height:48px; border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      color:#fff; font-size:20px;
      background:var(--blue-500); /* cor base */
    }

    .integration-info{
      flex:1;

      h3{
        margin:0 0 4px 0; font-size:18px; font-weight:600; color:var(--text-main);
      }

      .category{
        font-size:12px; color:var(--muted); text-transform:uppercase;
        font-weight:500; letter-spacing:.5px;
      }
    }

    .status-badge{
      padding:6px 12px; border-radius:20px; font-size:12px; font-weight:500;
      text-transform:uppercase; letter-spacing:.5px;

      &.status-connected{     background:#dcfce7; color:#166534; }
      &.status-error{         background:#fef2f2; color:#991b1b; }
      &.status-pending{       background:#fef3c7; color:#92400e; }
      &.status-disconnected{  background:color-mix(in srgb, var(--text-main) 6%, transparent); color:var(--text-main); }
    }
  }

  .card-body{
    padding:20px;

    .description{
      color:var(--muted); font-size:14px; line-height:1.5; margin:0 0 16px 0;
    }

    .features{
      display:flex; flex-wrap:wrap; gap:8px; margin-bottom:16px;

      .feature-tag{
        background:color-mix(in srgb, var(--text-main) 6%, transparent);
        color:var(--text-main);
        padding:4px 8px; border-radius:6px; font-size:12px; font-weight:500;
      }

      .feature-more{
        background:var(--border-color);
        color:var(--muted);
        padding:4px 8px; border-radius:6px; font-size:12px; font-weight:500;
      }
    }

    .metrics{
      display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:16px;

      .metric{
        text-align:center; padding:12px;
        background:var(--panel); border-radius:8px;

        .metric-label{
          display:block; font-size:11px; color:var(--muted);
          text-transform:uppercase; font-weight:500; letter-spacing:.5px; margin-bottom:4px;
        }

        .metric-value{ font-size:16px; font-weight:600; color:var(--text-main); }
      }
    }

    .last-sync{
      display:flex; align-items:center; gap:8px; font-size:12px; color:var(--muted);

      .pi-clock{ font-size:12px; }
    }
  }

  .card-actions{
    padding:16px 20px;
    background:var(--panel);
    display:flex; gap:8px; flex-wrap:wrap;

    button{
      padding:8px 16px; border-radius:6px; font-size:12px; font-weight:500;
      border:none; cursor:pointer; transition:all .2s; display:flex; align-items:center; gap:6px;
      color:#fff;

      i{ font-size:12px; }

      &.btn-primary{
        background:var(--blue-500);
        &:hover{ background:var(--blue-900); }
      }

      &.btn-secondary{
        background:var(--muted);
        color:var(--card-bg);
        &:hover{ background:color-mix(in srgb, var(--muted) 85%, #000 15%); }
      }

      &.btn-danger{
        background:#ef4444;
        &:hover{ background:#dc2626; }
      }

      &.btn-outline{
        background:transparent;
        color:var(--muted);
        border:1px solid var(--border-color);

        &:hover{
          background:var(--hover);
          border-color:color-mix(in srgb, var(--border-color) 70%, transparent);
        }
      }
    }
  }
}

/* ================= CLEAN MODAL ================= */
.clean-modal-overlay{
  position:fixed; inset:0;
  background:rgba(0,0,0,.5);
  display:flex; align-items:center; justify-content:center;
  z-index:1000; backdrop-filter:blur(4px);
}

.clean-modal{
  background:var(--card-bg);
  border-radius:16px;
  max-width:600px; width:90vw; max-height:80vh; overflow:hidden;
  box-shadow:0 25px 50px rgba(0,0,0,.25);
  display:flex; flex-direction:column;

  &.connect-modal{ max-width:500px; }

  .modal-header{
    padding:24px;
    border-bottom:1px solid color-mix(in srgb, var(--border-color) 80%, transparent);
    display:flex; align-items:center; justify-content:space-between;

    .integration-title{
      display:flex; align-items:center; gap:16px;

      .integration-icon{
        width:48px; height:48px; border-radius:12px;
        display:flex; align-items:center; justify-content:center;
        color:#fff; font-size:20px; background:var(--blue-500);
      }

      h2{
        margin:0 0 4px 0; font-size:20px; font-weight:600; color:var(--text-main);
      }

      .category{
        font-size:12px; color:var(--muted); text-transform:uppercase; font-weight:500; letter-spacing:.5px;
      }
    }

    .close-btn{
      width:32px; height:32px; border:none;
      background:var(--panel);
      border-radius:8px; display:flex; align-items:center; justify-content:center;
      cursor:pointer; color:var(--muted); transition:all .2s;

      &:hover{ background:color-mix(in srgb, var(--panel) 80%, var(--text-main) 20%); color:var(--text-main); }
    }
  }

  .modal-content{
    flex:1; overflow-y:auto; padding:24px;

    .info-section{
      margin-bottom:32px;
      &:last-child{ margin-bottom:0; }

      h3{
        margin:0 0 16px 0; font-size:16px; font-weight:600; color:var(--text-main);
      }

      .info-grid{
        display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px;

        .info-item{
          .label{
            display:block; font-size:12px; color:var(--muted); text-transform:uppercase;
            font-weight:500; letter-spacing:.5px; margin-bottom:4px;
          }
          .value{
            font-size:14px; font-weight:500; color:var(--text-main);

            &.status-connected{ color:#10b981; }
            &.status-error{ color:#ef4444; }
            &.status-pending{ color:#f59e0b; }
            &.status-disconnected{ color:#6b7280; }
          }
        }
      }

      .features-list{
        display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:12px;

        .feature-item{
          display:flex; align-items:center; gap:8px; font-size:14px; color:var(--text-main);

          .pi-check{ color:#10b981; font-size:12px; }
        }
      }

      .metrics-grid{
        display:grid; grid-template-columns:repeat(auto-fit, minmax(120px, 1fr)); gap:16px;

        .metric-card{
          text-align:center; padding:16px; background:var(--panel); border-radius:12px;

          .metric-value{
            font-size:20px; font-weight:600; color:var(--text-main); margin-bottom:4px;
          }
          .metric-label{
            font-size:12px; color:var(--muted); text-transform:uppercase; font-weight:500; letter-spacing:.5px;
          }
        }
      }
    }

    .form-section{
      .field{
        margin-bottom:20px;

        label{
          display:block; font-size:14px; font-weight:500; color:var(--text-main); margin-bottom:6px;
        }

        input, select{
          width:100%; padding:12px 16px;
          border:1px solid var(--border-color);
          border-radius:8px; font-size:14px;
          background:var(--card-bg); color:var(--text-main);
          transition:all .2s;

          &:focus{
            outline:none; border-color:var(--blue-500);
            box-shadow:0 0 0 3px color-mix(in srgb, var(--blue-500) 18%, transparent);
          }
        }

        &.checkbox-field label{
          display:flex; align-items:center; gap:12px; cursor:pointer;

          input[type="checkbox"]{ width:auto; margin:0; }
          .checkmark{ font-size:14px; color:var(--text-main); }
        }
      }
    }
  }

  .modal-actions{
    padding:24px;
    border-top:1px solid color-mix(in srgb, var(--border-color) 80%, transparent);
    display:flex; gap:12px; justify-content:flex-end;

    button{
      padding:12px 24px; border-radius:8px; font-size:14px; font-weight:500;
      border:none; cursor:pointer; transition:all .2s; display:flex; align-items:center; gap:8px; color:#fff;

      &.btn-primary{
        background:var(--blue-500);
        &:hover{ background:var(--blue-900); }
      }
      &.btn-secondary{
        background:var(--muted); color:var(--card-bg);
        &:hover{ background:color-mix(in srgb, var(--muted) 85%, #000 15%); }
      }
      &.btn-outline{
        background:transparent; color:var(--muted);
        border:1px solid var(--border-color);
        &:hover{
          background:var(--hover);
          border-color:color-mix(in srgb, var(--border-color) 70%, transparent);
        }
      }
    }
  }
}

/* ================= RESPONSIVO ================= */
@media (max-width:768px){
  .container-wrapper {
    padding: 1rem;
  }
  .card-header {
    flex-wrap: wrap;
  }

  .integrations-grid{ grid-template-columns:1fr; }

  .filters-section{
    flex-direction:column; align-items:stretch;

    .search-bar{ max-width:none; }

    .filter-selects{
      justify-content:stretch;
      flex-wrap: wrap;

      .filter-select{ flex:1; min-width:auto; }
    }
  }

  .clean-modal{
    width:95vw; max-height:90vh;

    .modal-content .info-section{
      .info-grid{ grid-template-columns:1fr; }
      .metrics-grid{ grid-template-columns:repeat(2, 1fr); }
    }
  }
}
