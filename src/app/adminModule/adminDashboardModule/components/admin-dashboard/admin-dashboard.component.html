<section class="container-wrapper">
  <header class="header">
    <h2>Dashboard</h2>
    <app-user-menu [username]="'Admin Sistema'" [email]="'admin@sistema.com'" [saldo]="0" [saldoProtesto]="0">
    </app-user-menu>
  </header>



  <div class="metrics-grid">
    <div class="metric-card sales-card">
      <div class="metric-header">
        <h3>{{ metricCards[0].title }}</h3>
        <div class="dropdown-trigger">
          <span>ÚLTIMA SEMANA</span>
          <i class="pi pi-chevron-down"></i>
        </div>
      </div>
      <div class="metric-value">{{ metricCards[0].value }}</div>
      <div class="chart-container">
        <canvas #salesChart></canvas>
      </div>
    </div>

    <div *ngFor="let card of metricCards.slice(1)" class="metric-card">
      <div class="metric-header">
        <h3>{{ card.title }}</h3>
      </div>
      <div class="metric-content">
        <div class="metric-info">
          <div class="metric-value">{{ card.value }}</div>
          <div class="metric-change" [class]="card.changeType">
            {{ card.change }} <span class="period">{{ card.period }}</span>
          </div>
        </div>
        <div class="mini-chart">
          <canvas #miniChart
            (ngAfterViewInit)="createMiniChart(miniChart, card.chartData, card.chartType, card.changeType === 'positive' ? '#00c896' : '#ff3b30')">
          </canvas>
        </div>
      </div>
    </div>
  </div>
  <div class="wallet-overview-section">
    <div class="wallet-balance-card">
      <div class="wallet-content">
        <div class="balance-info">
          <div class="balance-value">{{ walletBalance.balance }}</div>
          <div class="balance-label">Saldo da Carteira</div>
          <div class="balance-change" [class]="walletBalance.changeType">
            {{ walletBalance.change }} {{ walletBalance.period }}
          </div>
        </div>
        <div class="wallet-actions">
          <button class="change-btn">
            <i class="pi pi-refresh"></i>
            <span>Alterar</span>
          </button>
        </div>
      </div>
    </div>

    <div class="card-overview">
      <div class="overview-header">
        <h3>Pedidos pagos</h3>
        <p>PIX, cartão de crédito e chargebacks.</p>
      </div>

      <div class="overview-content">
        <div class="overview-list">
          <div *ngFor="let item of cardOverviewItems" class="overview-item">
            <div class="item-indicator" [style.background-color]="item.color"></div>
            <div class="item-info">
              <span class="item-label">{{ item.label }}</span>
              <span class="item-percentage">{{ item.percentage }}%</span>
            </div>
          </div>
        </div>

        <div class="overview-chart">
          <canvas #overviewChart></canvas>
        </div>
      </div>
    </div>
  </div>
  <!-- <div class="charts-section">
    <div class="chart-card funnel-card">
      <div class="chart-header">
        <h3>Funil de Vendas</h3>
        <i class="pi pi-ellipsis-h"></i>
      </div>

      <div class="funnel-metrics">
        <div *ngFor="let item of salesFunnelItems" class="funnel-item">
          <div class="funnel-icon" [style.background-color]="item.color">
            <i [class]="item.icon"></i>
          </div>
          <div class="funnel-info">
            <span class="funnel-label">{{ item.label }}</span>
            <span class="funnel-value">{{ item.value }}</span>
          </div>
        </div>
      </div>

      <div class="funnel-chart">
        <canvas #funnelChart></canvas>
      </div>
    </div>

    <div class="chart-card category-card">
      <div class="chart-header">
        <h3>Vendas por Categoria</h3>
        <div class="dropdown-trigger">
          <span>ÚLTIMA SEMANA</span>
          <i class="pi pi-chevron-down"></i>
        </div>
      </div>

      <div class="category-content">
        <div class="category-list">
          <div *ngFor="let category of categoryItems" class="category-item">
            <div class="category-info">
              <div class="category-dot"></div>
              <div class="category-details">
                <span class="category-name">{{ category.name }} ({{ category.percentage }}%)</span>
                <span class="category-products">{{ category.products }}</span>
              </div>
            </div>
          </div>
        </div>

        <div class="category-chart">
          <canvas #categoryChart></canvas>
          <div class="chart-center">
            <span class="total-value">R$ 6,8K</span>
          </div>
        </div>
      </div>
    </div>
  </div> -->

  <div class="table-section">
    <div class="table-header">
      <h3>Ultimas transações</h3>
      <div class="table-actions">
        <button class="filter-btn">
          <i class="pi pi-filter"></i>
          Filtrar e Ordenar
        </button>
      </div>
    </div>

    <div class="table-card">
      <table class="invoices-table">
        <thead>
          <tr>
            <th>Nº</th>
            <th>ID CLIENTE</th>
            <th>NOME DO CLIENTE</th>
            <th>ENDEREÇO DO CLIENTE</th>
            <th>DATA</th>
            <th>TIPO</th>
            <th>STATUS</th>
            <th>VALOR</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let invoice of recentInvoices">
            <td>{{ invoice.no }}</td>
            <td>{{ invoice.idCustomer }}</td>
            <td>{{ invoice.customerName }}</td>
            <td>{{ invoice.customerAddress }}</td>
            <td>{{ invoice.date }}</td>
            <td>{{ invoice.type }}</td>
            <td>
              <span [class]="'status-badge ' + getStatusClass(invoice.status)">
                {{ invoice.status === 'completed' ? 'Concluído' : invoice.status === 'pending' ? 'Pendente' :
                'Falhou' }}
              </span>
            </td>
            <td>{{ invoice.amount }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</section>